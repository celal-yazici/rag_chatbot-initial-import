{"chunk_index":"21","content":"*Tracking Duty:** `DMLTYPE$$`<br>**Tracking Duty Item:** `DMLTYPE$$`, `OLD_NEW$$`|**Tracking Duty:** when `XCREW.MLOG$_DUTY.DMLTYPE$$` = “D“<br>then “CANCELLED“ else “ACTIVE“<br>**Tracking Duty Item:** when `XCREW.MLOG$_DUTY.DMLTYPE$$` = “D“ or<br>(`XCREW.MLOG$_DUTY.DMLTYPE$$` = “U“ and `XCREW.MLOG$_DUTY.OLD_NEW$$` = “U“)<br>then “CANCELLED“ else “ACTIVE“| # Crew Layovers Data Model ### Data Retrieval #### - Data Retrieval Scope **Tracking Layover:** * Layover MLOG Insert&Delete Records: * Retrieve records where `XCREW.MLOG$_HOTEL_RESERVATION.SEQUENCE$$` > Sequence of the Latest Retrieved Data and `XCREW.MLOG$_HOTEL_RESERVATION.DMLTYPE$$` <> “U” and `XCREW.MLOG$_HOTEL_RESERVATION.RESERVATION_DATE` >= “01.01.2024“. * Layover MLOG Update Records: * Retrieve records where `XCREW.MLOG$_HOTEL_RESERVATION.SEQUENCE$$` > Sequence of the Latest Retrieved Data and `XCREW.MLOG$_HOTEL_RESERVATION.DMLTYPE$$` = “U” and `XCREW.MLOG$_HOTEL_RESERVATION.OLD_NEW$$` = “N” and `XCREW.MLOG$_HOTEL_RESERVATION.RESERVATION_DATE` >= “01.01.2024“. * Group these records by `XCREW.MLOG$_HOTEL_RESERVATION.TLC`, `XCREW.MLOG$_HOTEL_RESERVATION.RESERVATION_DATE`, `XCREW.MLOG$_HOTEL_RESERVATION.AIRPORT_CODE`, `XCREW.MLOG$_HOTEL_RESERVATION.COUNTER_PER_DAY`, `XCREW.MLOG$_HOTEL_RESERVATION.CHAIN_DAILY_UNO`, `XCREW.MLOG$_HOTEL_RESERVATION.ASSIGNED_RANK` and `XCREW.MLOG$_HOTEL_RESERVATION.RANK_SEQUENCE_NO` * Retrieve Max(`XCREW.MLOG$_HOTEL_RESERVATION.SEQUENCE$$`) within each group. **Hotel Info:** Retrieve all records from XCREW.HOTEL. #### - Source Query **Tracking Layover:** `Riverx_MLOG$_HOTEL_RESERVATION_Query` **Hotel Info:** `Riverx_HotelInfo_Query` #### - Data Retrieval Trigger & Steps **Trigger:** * **Tracking Layover:** Every 2 minutes * **Hotel Info:** Every day at 03:00 (UTC) **Steps:** * **Tracking Layover:** Execute `Riverx_MLOG$_HOTEL_RESERVATION_Query` query. * **Hotel Info:** Execute `Riverx_HotelInfo_Query` query. #### - Data Handling Operation **Tracking Layover:** * Crew Layover data","fm:title":"Crew Data Models description: published: true date: 2025-10-01T18:21:12.714Z tags: editor: markdown dateCreated: 2024-09-05T12:23:15.052Z","id":"gitlab://https://gitlab.com/avsos-wiki/riverx@main|sec=main|i=21|o=37800","length":"2000","offset":"37800","repo_branch":"main","repo_path":"river-x/source-mapping/crew-data-models.md","source":"gitlab://https://gitlab.com/avsos-wiki/riverx@main"}
