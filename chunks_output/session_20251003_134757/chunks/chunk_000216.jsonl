{"chunk_index":"8","content":"<li>&ldquo;DoorsOpened&rdquo;&nbsp;</li><li>&ldquo;EngineStart&ldquo;</li></ul>| # Flight Crew Data Model ### Data Retrieval #### - Data Retrieval Scope * Retrieve newly published events from the relevant EventHub topics. #### - Source Event Broker Topic * `crewFlight: com.riverx.topic.crew.crewflight` * `crewFlightTransport: com.riverx.topic.crew.crewflighttransport` #### - Source Query * `Riverx_FlightCrew_Query` #### - Data Retrieval Trigger & Steps * **Trigger:** Each new event published to the topic. * **Steps:** * Retrieve events. * Extract the `legId` from the received events. * Collect all `legId` values. * Remove duplicate `legId` entries. * Execute the `Riverx_FlightCrew_Query` using the `legId`. #### - Data Handling Operation **Integrator:** * Ignore the data when the `legId` attribute in the event is missing or null. **Handler Worker:** * The retrieved Flight Crew records are compared with the existing Flight Crew records in the RiverX Flight Crew Data Model. The `state` attributes of the records found in the RiverX Flight Crew Data Model but not in the retrieved Flight Crew records are set to \"DEL\". #### - Change Data Capture Operation * Unique Key: A composite key combining `legId` and `crewId` fields. * Insert and delete operations are carried out using Unique Key. * Delete operation is performed based on the value of `state` field(see Data Handling Operation for details). * No update operation is performed. ### Mapping |Model Attribute|Source Table|Source Field|Detail| |:----|:----|:----|:----| |extraInfo| | | | |flightId| | |N/A in the source system.| |crewId|`XCREW.DUTY`|`TLC`| | |crewName|`XCREW.DUTY d`, `XCREW.crew_member cm`|`d.TLC`, `cm.TLC`, `cm.name`|when `d.TLC` = `cm.TLC` then `cm.name`| |crewPosition|`XCREW.DUTY d`, `XCREW.RANK r`|`d.ASSIGNED_RANK`, `r.RANK`, `r.SHORT_NAME_FCT`|when `d.ASSIGNED_RANK` = `r.RANK` then `r.SHORT_NAME_FCT`| |crewRank| | |N/A in the source system.| |legId|**Duty Based Data:** `XCREW.DUTY d`, `SCHEDOPS.LEG l`<br>","fm:title":"Flight Data Models description: published: true date: 2025-09-17T08:21:41.502Z tags: editor: markdown dateCreated: 2024-09-05T12:25:02.351Z","id":"gitlab://https://gitlab.com/avsos-wiki/riverx@main|sec=main|i=8|o=14400","length":"2000","offset":"14400","repo_branch":"main","repo_path":"river-x/source-mapping/flight-data-models.md","source":"gitlab://https://gitlab.com/avsos-wiki/riverx@main"}
