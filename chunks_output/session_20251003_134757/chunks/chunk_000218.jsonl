{"chunk_index":"10","content":": `com.riverx.topic.in.flight.flightdelayisk.source` #### - Data Retrieval Trigger & Steps **Trigger:** * **Operational Delay:** Every minute * **Scheduled Delay:** Each new event published to the topic **Steps:** * **Operational Delay:** Executes `Riverx_FlightDelay_Query` query. * **Scheduled Delay:** * Retrieves the newly published event. * Extracts relevant fields from the event data. * Executes the `Riverx_ISKDelay_Query` using the extracted fields. * For each `leg_no` returned, generates a corresponding “IN” event. * Populates the “IN” events with the required static values. #### - Change Data Capture Operation * Unique Key: A composite key combining `legId` and `reasonOrder`(see Mapping for details). * Insert and update operations are carried out using Unique Key. * No delete operation is performed; instead, `status`(see Mapping for details) is updated based on the retrieved data. ### Mapping |Model Attribute|Source Table|Source Topic|Source Field|Detail| |:----|:----|:----|:----|:----| |extraInfo| | | | | |legId|**Operational Delay:** `SCHEDOPS.LEG`<br>**Scheduled Delay:** `SCHEDOPS.LEG`|**Scheduled Delay:** `flightdelayisk fd`|**Operational Delay:** `leg_no`<br>**Scheduled Delay:** `fd.carrier`,<br>`fd.flightNumber`, `fd.udor`,<br>`l.leg_no`, `l.fn_carrier`,<br>`l.fn_number`, `l.day_of_origin`|**Scheduled Delay:** when `fd.carrier` = `l.fn_carrier` and<br>`fd.flightNumber` = `l.fn_number` and `fd.udor` = `l.day_of_origin`<br>then `l.leg_no`| |reasonOrder|**Operational Delay:** `schedops.LEG_DELAY`| | **Operational Delay:** `NO`|**Scheduled Delay:** Sets to “ISK”| |delayCode|**Operational Delay:** `schedops.LEG_DELAY`| |**Operational Delay:** `code`|**Scheduled Delay:** Sets to “ISK”| |subDelayCode|**Operational Delay:** `schedops.LEG_DELAY`| |**Operational Delay:** `sub_code`| | |reasonOfDelay|**Operational Delay:** `schedops.LEG_DELAY`| |**Operational Delay:** `reason`| | |actualDuration|**Operational Delay:** `schedops.LEG_DELAY`| |**Operational Delay:** ","fm:title":"Flight Data Models description: published: true date: 2025-09-17T08:21:41.502Z tags: editor: markdown dateCreated: 2024-09-05T12:25:02.351Z","id":"gitlab://https://gitlab.com/avsos-wiki/riverx@main|sec=main|i=10|o=18000","length":"2000","offset":"18000","repo_branch":"main","repo_path":"river-x/source-mapping/flight-data-models.md","source":"gitlab://https://gitlab.com/avsos-wiki/riverx@main"}
